# nvd-api-query
scripts for querying the National Vulnerability Database


## cpe_find.sh 
A helper scipt to query the NVD's (National Vulnerability Database) API to retrieve possible cpes (Common Platform Enumerations) for a given software.

Information about CPEs: https://nvd.nist.gov/products/cpe

How to use:
cpe_find.sh [OPTION]... PROGRAM [VERSION]

### can run in 2 modes:
	* Interactive mode can will present info on each returned cpe and let you pick which
	to append to the specified file (either hardcoded in $outfile or
	set with the -o <outfile> flag.
 	* Minimal mode will only output the list of returned cpes to stdout. 

 	For both modes, the API will return a max 20 results, specify software versions
 	for better results. 	

## cve_query.sh
 Queries the National Vulnerability Database's Api to retrieve
 a list of cve's for a given cpe (Common Platform Enumerations, v2.3)

How to use:
```shell
 cve_query.sh [OPTION]... CPE
```
Options:
 -a INT		set age range in days (120 is the default and max accepted by api)
 -d		output to database (hardcoded in script)
 -h 		print help
 -j 		output in json (default:human readable)
 -r		run query and return raw result, no parsing or filtering

example:
	retrieve cves published in the last 30 days and output into database
	```shell
	cve_query.sh -a 30 -d "cpe:2.3:o:govicture:wr1200_firmware:*:*:*:*:*:*:*:*"
	```

 NOTE: queries without an API key will be time restricted to meet the NVD's requirements
 see: https://nvd.nist.gov/general/news/API-Key-Announcement

## db_manage.sh
some helper functions to make querying the sqlite db (if used) easy, to be expanded
usage:  
```shell
db_manage.sh COMMAND TERM"
```
### commands: 
 *search_program PROGRAM
 *search_cve CVE
 *search_cpe CPE

